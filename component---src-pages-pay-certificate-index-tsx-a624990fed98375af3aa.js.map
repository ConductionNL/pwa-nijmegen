{"version":3,"file":"component---src-pages-pay-certificate-index-tsx-a624990fed98375af3aa.js","mappings":"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","sources":["webpack://pwa/./src/components/vault/certificates.tsx","webpack://pwa/./src/pages/pay-certificate/index.tsx"],"sourcesContent":["import { Card } from \"@conductionnl/nl-design-system\";\nimport * as React from \"react\";\nimport { isLoggedIn } from \"../../services/auth\";\nimport { navigate } from \"gatsby-link\";\n\nexport default function Certificates() {\n  const [context, setContext] = React.useState(null);\n  React.useEffect(() => {\n    if (typeof window !== \"undefined\" && context === null) {\n      setContext({\n        apiUrl: window.GATSBY_API_URL,\n      });\n    } else {\n      if (isLoggedIn() && typeof window !== \"undefined\") {\n        const queryString = window.location.search;\n        if (queryString.length === 0) {\n          setPayment(\n            JSON.parse(window.sessionStorage.getItem(\"payment\") as string)\n          );\n          console.log(payment)\n        } else {\n          handlePayment();\n        }\n      }\n    }\n  }, [context]);\n\n  const [payment, setPayment] = React.useState(null);\n  const [loading, setLoading] = React.useState(null);\n  console.log(payment)\n\n  const handlePayment = () => {\n    setLoading(true);\n    const payment = JSON.parse(\n      window.sessionStorage.getItem(\"payment\") as string\n    );\n\n    if (typeof window !== \"undefined\") {\n      const queryString = window.location.search;\n      const urlParams = new URLSearchParams(queryString);\n      const orderId = urlParams.get(\"orderID\");\n\n      if (payment.orderId !== orderId) {\n        navigate(\"/vault\");\n      }\n\n      fetch(\n        `${context.apiUrl}/gateways/waardepapieren-service/payments/${payment.id}/certificate${queryString}`,\n        {\n          credentials: \"include\",\n          headers: {\n            \"Content-Type\": \"application/json\",\n          },\n        }\n      )\n        .then((response) => response.json())\n        .then((data) => {\n          navigate(\"/vault\");\n        });\n    }\n  };\n\n  const handleBack = () => {\n    if (typeof window !== \"undefined\") {\n      window.sessionStorage.removeItem(\"payment\");\n      navigate(\"/\");\n    }\n  };\n\n  return (\n    <>\n      <div>\n        {loading !== null && (\n          <div className=\"text-center\">\n            <div className=\"spinner-border\" role=\"status\">\n              <span className=\"sr-only\">Loading...</span>\n            </div>\n          </div>\n        )}\n        {payment !== null && (\n          <form method=\"POST\" action={payment.redirectUrl}>\n            <div className=\"row\">\n              <div className=\"col-12\">\n                <h4 className=\"utrecht-heading-4\">\n                  <strong>Waardepapier:</strong>{\" \"}\n                  {payment.type.replaceAll(\"_\", \" \")}\n                </h4>\n              </div>\n              <div className=\"col-12\">\n                <h4 className=\"utrecht-heading-4\">\n                  <strong>Kost:</strong> € {payment.price / 100},-\n                </h4>\n              </div>\n              <div className=\"col-12\">\n                <button className={\"utrecht-button\"}>Betalen</button>\n              </div>\n            </div>\n            {Object.entries(payment.configuration).map(\n              ([key, value]) => {\n                return (\n                  <input\n                    key={key}\n                    type=\"hidden\"\n                    name={key}\n                    value={value}\n                  />\n                );\n              }\n            )}\n          </form>\n        )}\n        <Card\n          title={\"Betalen\"}\n          cardHeader={function () {\n            return (\n              <>\n                {loading === null && (\n                  <button onClick={handleBack} className=\"utrecht-button\">\n                    Terug\n                  </button>\n                )}\n              </>\n            );\n          }}\n          cardBody={function () {\n            return (\n              <>\n                {loading !== null && (\n                    <div className=\"text-center\">\n                      <div className=\"spinner-border\" role=\"status\">\n                        <span className=\"sr-only\">Loading...</span>\n                      </div>\n                    </div>\n                )}\n                {payment !== null && (\n                  <form method=\"POST\" action={payment.redirectUrl}>\n                    <div className=\"row\">\n                      <div className=\"col-12\">\n                        <h4 className=\"utrecht-heading-4\">\n                          <strong>Waardepapier:</strong>{\" \"}\n                          {payment.type.replaceAll(\"_\", \" \")}\n                        </h4>\n                      </div>\n                      <div className=\"col-12\">\n                        <h4 className=\"utrecht-heading-4\">\n                          <strong>Kost:</strong> € {payment.price / 100},-\n                        </h4>\n                      </div>\n                      <div className=\"col-12\">\n                        <button className={\"utrecht-button\"}>Betalen</button>\n                      </div>\n                    </div>\n                    {Object.entries(payment.configuration).map(\n                      ([key, value]) => {\n                        return (\n                          <input\n                            key={key}\n                            type=\"hidden\"\n                            name={key}\n                            value={value}\n                          />\n                        );\n                      }\n                    )}\n                  </form>\n                )}\n              </>\n            );\n          }}\n        />\n      </div>\n    </>\n  );\n}\n","import * as React from \"react\";\nimport Layout from \"../../components/common/layout\";\nimport Certificates from \"../../components/vault/certificates\";\nimport { isLoggedIn } from \"../../services/auth\";\n\nconst IndexPage = () => {\n  React.useEffect(() => {\n    if (typeof window !== \"undefined\") {\n      setContext({\n        baseUrl: window.GATSBY_BASE_URL,\n        frontendUrl: window.GATSBY_FRONTEND_URL,\n      });\n    }\n  }, []);\n  const [context, setContext] = React.useState({\n    baseUrl: \"\",\n    frontendUrl: \"\",\n  });\n\n  return (\n    <Layout>\n      <main>\n        <div className={\"text-center mt-4\"}>\n          {isLoggedIn() ? (\n            <>\n              <Certificates />\n            </>\n          ) : (\n            <>\n              <h1 className=\"utrecht-heading-1 utrecht-heading-1--distanced\">\n                Welkom\n              </h1>\n              <h4 className=\"utrecht-heading-4 utrecht-heading-4--distanced\">\n                U dient ingelogd te zijn om door te gaan.\n              </h4>\n              <div className={\"mt-4\"}>\n                <a\n                  className={\"utrecht-link\"}\n                  href={\n                    context.baseUrl +\n                    \"/digid/login?returnUrl=\" +\n                    context.frontendUrl +\n                    \"/redirect\"\n                  }\n                >\n                  <button className={\"utrecht-button\"}>Inloggen</button>\n                </a>\n              </div>\n            </>\n          )}\n        </div>\n      </main>\n    </Layout>\n  );\n};\n\nexport default IndexPage;\n"],"names":["Certificates","React","context","setContext","window","apiUrl","GATSBY_API_URL","isLoggedIn","location","search","length","setPayment","JSON","parse","sessionStorage","getItem","console","log","payment","handlePayment","loading","setLoading","queryString","orderId","URLSearchParams","get","navigate","fetch","id","credentials","headers","then","response","json","data","handleBack","removeItem","className","role","method","action","redirectUrl","type","replaceAll","price","Object","entries","configuration","map","key","value","name","Card","title","cardHeader","onClick","cardBody","baseUrl","GATSBY_BASE_URL","frontendUrl","GATSBY_FRONTEND_URL","href"],"sourceRoot":""}